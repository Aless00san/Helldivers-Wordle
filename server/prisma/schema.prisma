// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Stratagem {
  id        String   @id @default(uuid())
  name      String
  code      Json       
  category  String                 
  enabled   Boolean  @default(true)
  createdAt DateTime @default(now())

  games     Game[]
}

enum GameStatus {
  IN_PROGRESS
  WON
  LOST
  ABANDONED
}

model Game {
  id           String     @id @default(uuid())
  stratagem    Stratagem  @relation(fields: [stratagemId], references: [id], onDelete: Cascade)
  stratagemId  String
  createdAt    DateTime   @default(now())
  status       GameStatus @default(IN_PROGRESS)
  user         User?      @relation(fields: [userId], references: [id])
  userId       Int?

  @@unique([userId, createdAt])
}

model User {
  id        Int   @id @default(autoincrement())
  name      String
  email     String   @unique
  createdAt DateTime @default(now())
  games    Game[]
  discordId String @unique
}
